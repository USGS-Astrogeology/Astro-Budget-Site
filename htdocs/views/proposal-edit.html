<!DOCTYPE html>
<html>
    <head>
        <title>Proposal Budget for {{ proposals[0].projectname }} </title>
        {% include 'menu-header.html' %}
    </head>
    {% for error in debug %}
      <pre>error.msg</pre>
    {% endfor %}
    <body>
        {% include 'menu-tags.html' %}
      <div class="container">
        <div id="title">
          <h2>Proposal</h2>
        </div>
        <div id="warningDiv" class="ui-corner-all ui-state-highlight" style="width=100px;align=right;"></div>
        <div id="editDialog" class="ui-widget"></div>
        <div id="accordions">
          <h3 id='projectnameaccordion'>Proposal Details - {{ proposals[0].projectname }}</h3>
            <div>
              <form id="proposalForm" action="index.php" method="GET">
              <table>
                <tr><th>Project Name</th>
                  <td colspan="3"><input type='text' name='projectname' size="70"
                      value='{{ proposals[0].projectname }}'/></td></tr>
                <tr><th>Principal Investigator</th>
                  <td colspan="3">
                {% include 'people-dropdown.html' with {'dropdown_name': 'conferencepeopleid',
                                                        'dropdown_id': 'conferencepeopledropdown',
                                                        'selected_peopleid': proposals[0].peopleid } %}
                  </td></tr>
                <tr><th>Funding Program</th><td colspan="3">
                {% include 'programs-dropdown.html' with {'dropdown_name': 'programid',
                                                          'dropdown_id': 'programiddropdown',
                                                          'selected_programid': proposals[0].programid } %}
                  </td></tr>
                <tr><th>Proposal Number</th>
                  <td><input type='text' name='proposalnumber' value='{{ proposals[0].proposalnumber }}'/></td>
                  <th>Award Number</th>
                  <td><input type='text' name='awardnumber' value='{{ proposals[0].awardnumber }}'/></td></tr>
                <tr><th>Starting</th>
                  <td><input type='text' id='proposalperfperiodstart' name='perfperiodstart' 
                       value='{{ proposals[0].perfperiodstart }}'/></td>
                  <th>Ending</th>
                  <td><input type='text' id='proposalperfperiodend' name='perfperiodend' 
                       value='{{ proposals[0].perfperiodend }}'/></td></tr>
                </tr>
              </table>
              </form>
            </div>
          <h3>Tasks</h3>
            <div id='tasksdiv' style='height: 400px;'>
              <a href='javascript:void(0)' onClick="editTask('new')" id='newTaskButton'>New</a><p/>
              <table id='tasksTable' class='display' cellspacing='0' width='100%'>
                <thead><tr><th>Task</th><th>Staffing</th><th>Hours</th><th>Est. Cost<br/>(Est Sal + Ben)</th></tr></thead>
              </table>
            </div>

          <h3>Conferences/Meetings/Travel</h3>
            <div>
              <a href='javascript:void(0)' onClick="editTask('new')" id='newConferenceButton'>New</a><p/>
              <table id='conferencesTable' class='display' cellspace='0' width='100%'>
                <thead><tr><th>Meeting</th><th>Attendee</th><th>Starting</th><th>Meeting<br/>Days</th><th>Travel<br/>Days</th></tr></thead>
              </table>
            </div>
          <h3>Expenses</h3>
            <div>
              <a href='javascript:void(0)' onClick="editTask('new')" id='newExpenseButton'>New</a><p/>
              <table id='expensesTable' class='display' cellspace='0' width='100%'>
                <thead><tr><th>Expense</th><th>Type</th><th>Amount</th><th>Fiscal</th></tr></thead>
              </table>
            </div>
        </div>

      <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
          $('#proposalperfperiodstart').datepicker();
          $('#proposalperfperiodend').datepicker();
          $('#newTaskButton').button();
          $('#newConferenceButton').button();
          $('#newExpenseButton').button();

          $('#tasksTable').dataTable( {
            'processing': true,
            'serverSide': false,
            'autoWidth': false,
            'ajax': 'index.php?view=tasks-list-json&proposalid={{ proposals[0].proposalid}}',
            'lengthMenu': [[10, 25, 50, -1], [10, 25, 50, 'All']]
          } );
          $('#conferencesTable').dataTable( {
            'processing': true,
            'serverSide': false,
            'autoWidth': false,
            'ajax': 'index.php?view=conference-attendee-list-json&proposalid={{ proposals[0].proposalid}}',
            'lengthMenu': [[5, 10, 20, -1], [5, 10, 20, 'All']]
          } );
          $('#expensesTable').dataTable( {
            'processing': true,
            'serverSide': false,
            'autoWidth': false,
            'ajax': 'index.php?view=expense-list-json&proposalid={{ proposals[0].proposalid}}',
            'lengthMenu': [[5, 10, 20, -1], [5, 10, 20, 'All']]
          } );
          $('#accordions').accordion( {heightStyle: 'content' });
        } );
      </script>
    </body>
</html>
